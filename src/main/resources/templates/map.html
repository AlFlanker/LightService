<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>

    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <link rel="stylesheet" type="text/css" media="all"
          href="../static/css/map.css" th:href="@{/css/map.css}" />

    <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.3.0/sockjs.min.js"></script>-->
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>

    <div th:insert="~{bootstrap_elem :: head}"></div>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css"
          integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="
          crossorigin=""/>

    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js"
            integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA=="
            crossorigin=""></script>

    <script src="map_api/Legend/Leaflet.Control.Custom.js"></script>
<!---->
</head>
<body>
<meta name="user_role" data-th-attr="content=${#authentication.getAuthorities()}"/>
<div th:insert="~{bootstrap_elem :: body}"></div>
<div th:insert="~{navbar_thy :: navbar_parts}"></div>
<div th:insert="~{security_data :: csrf_fragment}"></div>
<div th:insert="~{showDialogControl :: control_dialog}"></div>
<div th:insert="~{addMapGroupDialog :: addGroupDialogFrag}"></div>
<div th:include="~{map_fragment :: map_add_to_group }"></div>
<script type="text/javascript" src="/map_api/map_DOM_elems_and_var.js" defer></script>
<script type="text/javascript" src="/map_api/map_runtime_view_events.js" defer></script>
<div th:if="${mode}=='edit'" style=margin-left:45%;><h5>Режим редактирования</h5></div>
<div th:if="${mode}=='view'" style=margin-left:45%;><h5>Режим просмотра</h5></div>


<!--ToDo: Сделать карту модульной!-->
<!--<script type="text/javascript" th:src="${isDevMode} ? 'http://localhost:8001/map-min.js': '/production/map-min.js'" defer></script>-->
<div class="container-fluid mt-2 fill" >
    <div id="mapid" style="height: 800px" ></div>
</div>
<!--<script type="text/javascript" src="/production/map-min.js" defer></script>-->
<div th:include="~{map_fragment :: map_switch (${mode})}"></div>

</body>

</html>